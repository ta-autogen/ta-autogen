#include <stdio.h>
#include <string.h>
#include <openssl/hmac.h>
#include <openssl/evp.h>
#include <assert.h>

int main() {
    unsigned int len256 = 32, len384 = 48, len512 = 64;
    unsigned char smd[len256], mmd[len384], lmd[len512];
    
    unsigned int kl = 32;
    unsigned char secret_key[kl], secret[kl];
    
    memset(secret, 0x61, kl);
    memset(secret_key, 0x01, kl);
    
    //printf("HMAC SHA256\nExpected: f7acae7458b602989854360705153f32ce7ddda21f3dae0f0e7c8a94e9db882\nResult:   ");
    unsigned char res1[] = {0xf7,0xac,0xae,0x7,0x45,0x8b,0x60,0x29,0x89,0x85,0x43,0x60,0x70,0x51,0x53,0xf3,0x2c,0xe7,0xdd,0xda,0x21,0xf3,0xda,0xe0,0xf0,0xe7,0xc8,0xa9,0x4e,0x9d,0xb8,0x82};
    HMAC(EVP_sha256(), secret_key, kl, secret, 32, smd, &len256);
    assert(memcmp(res1, smd, len256)==0);
    printf("HMAC SHA256 calculation succeeded\n");

    //printf("HMAC SHA384\nExpected: 861f2c4353dcf12eae8678e9575cdb4b2213a845e6e93b9558c57bb4f31250500fbd8a2995967f92cd9945c0913b\nResult:   ");
    unsigned char res2[] = {0x86,0x1f,0x2c,0x43,0x53,0xdc,0xf,0x12,0xea,0xe8,0x67,0x8e,0x95,0x75,0xcd,0xb4,0xb2,0x21,0x3a,0x84,0x5,0xe6,0xe9,0x3b,0x95,0x58,0xc5,0x7b,0xb4,0xf3,0x12,0x50,0x50,0x0,0xfb,0xd,0x8a,0x29,0x95,0x96,0x7f,0x92,0xcd,0x99,0x45,0xc0,0x91,0x3b};
    HMAC(EVP_sha384(), secret_key, kl, secret, 32, mmd, &len384);
    assert(memcmp(res2, mmd, len384)==0);
    printf("HMAC SHA384 calculation succeeded\n");

    //printf("HMAC SHA512\nExpected: 7958831648643789f9226b584d106f6f7af13039685b4ed87a2ce238e2941d8d9e26d8eaea78681159141fb4fa169660dbc1721617e89833e16bccc8\nResult:   ");
    unsigned char res3[] = {0x79,0x58,0x83,0x1,0x64,0x86,0x43,0x78,0x9f,0x92,0x26,0xb5,0x84,0xd1,0x0,0x6f,0x6f,0x7a,0xf1,0x30,0x39,0x6,0x85,0xb4,0xed,0x8,0x7a,0x2,0xce,0x23,0x8e,0x29,0x41,0xd8,0xd9,0xe2,0x6d,0x8e,0xae,0xa7,0x86,0x81,0x1,0x59,0x14,0x1f,0xb4,0xfa,0x16,0x96,0x60,0xd,0xbc,0x17,0x21,0x61,0x7e,0x89,0x83,0x3e,0x1,0x6b,0xcc,0xc8};
    HMAC(EVP_sha512(), secret_key, kl, secret, 32, lmd, &len512);
    assert(memcmp(res3, lmd, len512)==0);
    printf("HMAC SHA512 calculation succeeded\n");

    return 0;
}
